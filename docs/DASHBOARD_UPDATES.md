# Dashboard 布局更新说明

## 最新更新 (v2.0)

### 1. 布局优化
- **左侧**: 资产收益曲线图（高度提升至600px，更清晰展示走势）
- **右侧**: 多功能面板，通过美化的Tab按钮切换显示以下内容：
  - 🏆 AI排行榜
  - 💼 交易记录
  - 📊 持仓情况（新增饼图可视化）

### 2. Tab按钮美化设计
- **未选中状态**: 白色背景，灰色边框，悬停时有上浮动画效果
- **选中状态**: 蓝色渐变背景，白色文字，带有阴影效果
- **交互效果**:
  - 悬停时向上移动2px
  - 悬停时边框变蓝
  - 平滑的过渡动画
  - 选中时有更强的阴影

### 3. 持仓情况饼图
新增功能，直观显示持仓分布：
- **环形饼图**: 使用Chart.js的doughnut类型
- **颜色方案**: 8种鲜明色彩区分不同股票
- **图例显示**: 底部显示股票名称和占比百分比
- **交互提示**: 悬停显示详细信息（股票名、市值、占比）
- **响应式**: 自动适应容器大小

### 4. 图表高度调整
- 资产收益曲线从400px提升至**600px**
- 持仓饼图高度为280px，与详细列表完美配合

## 文件变更

### HTML (docs/index.html)
- 在持仓Tab中添加了饼图容器
- 持仓内容分为上下两部分：饼图区域 + 详细列表

### CSS (docs/css/style.css)
- 优化Tab按钮样式（渐变背景、阴影、动画）
- 添加持仓饼图区域样式
- 提升图表容器高度
- 优化滚动条样式

### JavaScript (docs/js/competition.js)
- 添加`pieChart`全局变量管理饼图实例
- 添加`renderPieChart()`函数渲染持仓分布饼图
- 更新`renderPositions()`收集饼图数据
- 饼图支持自定义图例（显示百分比）

## 视觉效果

### Tab按钮
```
┌─────────────┐  ┌─────────────┐  ┌─────────────┐
│  🏆 排行榜  │  │  💼 交易    │  │  📊 持仓    │
│  [选中态]   │  │  [默认态]   │  │  [悬停态]   │
│ 蓝色渐变bg  │  │  白色bg     │  │  蓝色边框   │
│  白色文字   │  │  灰色文字   │  │  向上浮动   │
└─────────────┘  └─────────────┘  └─────────────┘
```

### 持仓页面布局
```
┌──────────────────────────────┐
│     持仓分布饼图 (280px)      │
│        🟦 🟩 🟨 🟥           │
│   股票A: 35% | 股票B: 25%    │
├──────────────────────────────┤
│   详细持仓列表（可滚动）      │
│   ├─ 股票A (600157.SH)       │
│   │  持仓: 1000股            │
│   │  成本: ¥10.50 现价: ¥12 │
│   │  盈亏: +14.29%           │
│   ├─ 股票B (000001.SZ)       │
│   └─ ...                     │
└──────────────────────────────┘
```

## 上证指数基准
- 数据范围：2025-10-15 至 2025-10-27 (9天)
- 在图表中以**黑色实线**显示（线宽2.5px）
- 在排行榜底部显示作为参考基准

## 使用说明

1. **启动本地预览**:
   ```bash
   cd docs
   python -m http.server 8000
   ```
   然后访问 http://localhost:8000

2. **切换查看内容**:
   - 点击右侧面板顶部的三个按钮切换不同视图
   - 在交易记录和持仓情况中使用下拉选择器选择不同的AI

3. **查看持仓分布**:
   - 切换到"📊 持仓情况"Tab
   - 顶部饼图显示各股票市值占比
   - 下方列表显示详细持仓信息
   - 悬停饼图查看具体金额和占比

4. **对比表现**:
   - 图表中的黑色实线代表上证指数表现
   - 排行榜底部显示上证指数的收益率作为参考

## 数据更新

更新上证指数数据:
```bash
python scripts/fetch_index_benchmark.py
```

更新AI交易数据后复制到docs目录:
```bash
python scripts/copy_data_to_docs.py
```

## 技术细节

### 饼图配置
- 类型: `doughnut` (环形图)
- 颜色: 8种预设颜色循环使用
- 图例: 底部显示，自定义格式（名称 + 百分比）
- 工具提示: 显示完整信息（名称、金额、百分比）

### 性能优化
- 切换Agent时自动销毁旧图表实例
- 无持仓时清空饼图，避免内存泄漏
- 响应式设计，自动适配不同屏幕尺寸
